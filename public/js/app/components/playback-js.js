// resources/js/playback.js
function leafletAISMaps() {
  let markerClusterEnabled = false;
  let markers;
  let map;
  let trackPlayback;
  return {
    init: async function() {
      map = L.map(this.$refs.map.id).setView(
        [-1.5499571228201094, 117.89427962462793],
        5.4
      );
      const tiles = L.tileLayer.provider("OpenStreetMap.Mapnik").addTo(map);
      const baseLayers = {
        OpenStreetMap: tiles,
        "Google Maps": L.tileLayer(
          "https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}",
          {
            attribution: "Google Maps"
          }
        )
      };
      var ts = new L.aisTrackSymbol({});
      ts.addData({
        msgId: 4,
        mmsi: 24422002,
        name: "demo",
        utcYear: 2016,
        utcMon: 11,
        utcDay: 14,
        utcHour: 13,
        utcMin: 40,
        utcSec: 30,
        posAcc: 1,
        longitude: 8.155278333333333,
        latitude: 54.185555,
        devType: 7,
        raim: 0,
        comstate: { syncState: 0, slotTimeout: 2, slotNr: 1150 },
        timestamp: 1479130830744
      });
      ts.addTo(map);
      try {
        const response = await axios.get(
          "https://lumensopbuntut.cakrawala.id/api/aisdataunique"
        );
        const aisData = response.data.message;
        markers = createMarkers(aisData, markerClusterEnabled);
        map.addLayer(markers);
      } catch (error) {
        console.error("Error fetching AIS data:", error);
      }
      try {
        const data = {
          mmsi: "",
          dateFrom: "2024-01-03",
          dateTo: "2024-01-04",
          sensor: ["ais"]
        };
        const playbackResponse = await axios.post(
          "https://backend.sopbuntutksopbjm.com/api/playback",
          data
        );
        const playbackData = playbackResponse.data.message.ais[0].playback;
        trackPlayback = L.trackplayback(playbackData, map, {
          trackPointOptions: {
            /* Additional options for track points */
          },
          markerOptions: {
            /* Additional options for playback markers */
          }
        });
        const trackplaybackControl = L.trackplaybackcontrol(trackPlayback);
        trackplaybackControl.addTo(map);
        trackPlayback.start();
      } catch (error) {
        console.error("Error fetching AIS data:", error);
      }
      map.on("load", function() {
      });
      map.pm.setGlobalOptions({ optIn: false });
      map.pm.addControls({
        position: "topleft",
        drawMarker: false
        // Disable drawing markers (use your cluster markers instead)
      });
      L.control.locate().addTo(map);
      L.terminator().addTo(map);
      setInterval(function() {
        terminator.setTime();
      }, 6e4);
      const sidebar = L.control.sidebar({
        autopan: false,
        closeButton: true,
        container: "sidebar",
        position: "left"
      }).addTo(map);
      sidebar.addPanel({
        id: "Content",
        tab: '<i class="fa fa-info"></i>',
        pane: `
                       <button id="toggleMarkerCluster">Toggle Marker Cluster</button>
                       <button id="startPlayback">Start Playback</button>
        <button id="stopPlayback">Stop Playback</button>`,
        title: "Sidebar",
        position: "top"
      });
      L.control.layers(baseLayers).addTo(map);
      document.getElementById("toggleMarkerCluster").addEventListener("click", async function() {
        markerClusterEnabled = !markerClusterEnabled;
        map.removeLayer(markers);
        try {
          const response = await axios.get(
            "https://ksop.cakrawala.id/api/aisdataunique"
          );
          const aisData = response.data.message;
          markers = createMarkers(aisData, markerClusterEnabled);
          map.addLayer(markers);
        } catch (error) {
          console.error("Error fetching AIS data:", error);
        }
      });
      document.getElementById("startPlayback").addEventListener("click", function() {
        trackPlayback.start();
      });
      document.getElementById("stopPlayback").addEventListener("click", function() {
        trackPlayback.stop();
      });
    }
  };
}
function createMarkers(data, markerClusterEnabled) {
  const newMarkers = markerClusterEnabled ? L.markerClusterGroup() : L.featureGroup();
  data.forEach((aisItem) => {
    const marker = L.marker([
      aisItem.latitude,
      aisItem.longitude
    ]).bindPopup(`AIS Data: ${JSON.stringify(aisItem)}`);
    if (aisItem.is_inside_geofence === 1) {
      const pulsingIcon = L.icon.pulse({
        iconSize: [10, 10],
        color: "red",
        fillColor: "red",
        animate: true,
        pulseColor: "red"
      });
      marker.setIcon(pulsingIcon);
    }
    newMarkers.addLayer(marker);
  });
  return newMarkers;
}
export {
  leafletAISMaps as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vcGxheWJhY2suanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxlYWZsZXRBSVNNYXBzKCkge1xyXG4gICAgbGV0IG1hcmtlckNsdXN0ZXJFbmFibGVkID0gZmFsc2U7XHJcbiAgICBsZXQgbWFya2VycztcclxuICAgIGxldCBtYXA7XHJcbiAgICBsZXQgdHJhY2tQbGF5YmFjaztcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaW5pdDogYXN5bmMgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBtYXAgPSBMLm1hcCh0aGlzLiRyZWZzLm1hcC5pZCkuc2V0VmlldyhcclxuICAgICAgICAgICAgICAgIFstMS41NDk5NTcxMjI4MjAxMDk0LCAxMTcuODk0Mjc5NjI0NjI3OTNdLFxyXG4gICAgICAgICAgICAgICAgNS40XHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB0aWxlcyA9IEwudGlsZUxheWVyXHJcbiAgICAgICAgICAgICAgICAucHJvdmlkZXIoXCJPcGVuU3RyZWV0TWFwLk1hcG5pa1wiKVxyXG4gICAgICAgICAgICAgICAgLmFkZFRvKG1hcCk7XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBiYXNlIGxheWVycyBvYmplY3RcclxuICAgICAgICAgICAgY29uc3QgYmFzZUxheWVycyA9IHtcclxuICAgICAgICAgICAgICAgIE9wZW5TdHJlZXRNYXA6IHRpbGVzLFxyXG4gICAgICAgICAgICAgICAgXCJHb29nbGUgTWFwc1wiOiBMLnRpbGVMYXllcihcclxuICAgICAgICAgICAgICAgICAgICBcImh0dHBzOi8vbXQxLmdvb2dsZS5jb20vdnQvbHlycz1yJng9e3h9Jnk9e3l9Jno9e3p9XCIsXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogXCJHb29nbGUgTWFwc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB2YXIgdHMgPSBuZXcgTC5haXNUcmFja1N5bWJvbCh7fSk7XHJcblxyXG4gICAgICAgICAgICB0cy5hZGREYXRhKHtcclxuICAgICAgICAgICAgICAgIG1zZ0lkOiA0LFxyXG4gICAgICAgICAgICAgICAgbW1zaTogMjQ0MjIwMDIsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImRlbW9cIixcclxuICAgICAgICAgICAgICAgIHV0Y1llYXI6IDIwMTYsXHJcbiAgICAgICAgICAgICAgICB1dGNNb246IDExLFxyXG4gICAgICAgICAgICAgICAgdXRjRGF5OiAxNCxcclxuICAgICAgICAgICAgICAgIHV0Y0hvdXI6IDEzLFxyXG4gICAgICAgICAgICAgICAgdXRjTWluOiA0MCxcclxuICAgICAgICAgICAgICAgIHV0Y1NlYzogMzAsXHJcbiAgICAgICAgICAgICAgICBwb3NBY2M6IDEsXHJcbiAgICAgICAgICAgICAgICBsb25naXR1ZGU6IDguMTU1Mjc4MzMzMzMzMzMzLFxyXG4gICAgICAgICAgICAgICAgbGF0aXR1ZGU6IDU0LjE4NTU1NSxcclxuICAgICAgICAgICAgICAgIGRldlR5cGU6IDcsXHJcbiAgICAgICAgICAgICAgICByYWltOiAwLFxyXG4gICAgICAgICAgICAgICAgY29tc3RhdGU6IHsgc3luY1N0YXRlOiAwLCBzbG90VGltZW91dDogMiwgc2xvdE5yOiAxMTUwIH0sXHJcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IDE0NzkxMzA4MzA3NDQsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0cy5hZGRUbyhtYXApO1xyXG5cclxuICAgICAgICAgICAgLy8gRmV0Y2ggQUlTIGRhdGEgZnJvbSB0aGUgQVBJIGFuZCBjcmVhdGUgbWFya2Vyc1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoXHJcbiAgICAgICAgICAgICAgICAgICAgXCJodHRwczovL2x1bWVuc29wYnVudHV0LmNha3Jhd2FsYS5pZC9hcGkvYWlzZGF0YXVuaXF1ZVwiXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWlzRGF0YSA9IHJlc3BvbnNlLmRhdGEubWVzc2FnZTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbWFya2VycyBvciBtYXJrZXIgY2x1c3RlciBiYXNlZCBvbiB0aGUgaW5pdGlhbCBkYXRhXHJcbiAgICAgICAgICAgICAgICBtYXJrZXJzID0gY3JlYXRlTWFya2VycyhhaXNEYXRhLCBtYXJrZXJDbHVzdGVyRW5hYmxlZCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBtYXJrZXJzIG9yIG1hcmtlciBjbHVzdGVyIHRvIHRoZSBtYXBcclxuICAgICAgICAgICAgICAgIG1hcC5hZGRMYXllcihtYXJrZXJzKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBBSVMgZGF0YTpcIiwgZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBGZXRjaCBBSVMgZGF0YSBmcm9tIHRoZSBBUEkgYW5kIGNyZWF0ZSBtYXJrZXJzXHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIG1tc2k6IFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZUZyb206IFwiMjAyNC0wMS0wM1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGVUbzogXCIyMDI0LTAxLTA0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgc2Vuc29yOiBbXCJhaXNcIl0sXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGxheWJhY2tSZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoXHJcbiAgICAgICAgICAgICAgICAgICAgXCJodHRwczovL2JhY2tlbmQuc29wYnVudHV0a3NvcGJqbS5jb20vYXBpL3BsYXliYWNrXCJcclxuICAgICAgICAgICAgICAgICwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwbGF5YmFja0RhdGEgPSBwbGF5YmFja1Jlc3BvbnNlLmRhdGEubWVzc2FnZS5haXNbMF0ucGxheWJhY2s7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGEgVHJhY2tQbGF5YmFjayBpbnN0YW5jZVxyXG4gICAgICAgICAgICAgICAgdHJhY2tQbGF5YmFjayA9IEwudHJhY2twbGF5YmFjayhwbGF5YmFja0RhdGEsIG1hcCwge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrUG9pbnRPcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIEFkZGl0aW9uYWwgb3B0aW9ucyBmb3IgdHJhY2sgcG9pbnRzICovXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBtYXJrZXJPcHRpb25zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIEFkZGl0aW9uYWwgb3B0aW9ucyBmb3IgcGxheWJhY2sgbWFya2VycyAqL1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCB0cmFja3BsYXliYWNrQ29udHJvbCA9IEwudHJhY2twbGF5YmFja2NvbnRyb2wodHJhY2tQbGF5YmFjayk7XHJcblxyXG4gICAgdHJhY2twbGF5YmFja0NvbnRyb2wuYWRkVG8obWFwKTtcclxuXHJcbiAgICAgICAgICAgICAgICB0cmFja1BsYXliYWNrLnN0YXJ0KCk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgQUlTIGRhdGE6XCIsIGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWFwLm9uKFwibG9hZFwiLCBmdW5jdGlvbiAoKSB7fSk7XHJcblxyXG4gICAgICAgICAgICAvLyBFbmFibGUgTGVhZmxldC1HZW9tYW4gb24gdGhlIG1hcFxyXG4gICAgICAgICAgICBtYXAucG0uc2V0R2xvYmFsT3B0aW9ucyh7IG9wdEluOiBmYWxzZSB9KTsgLy8gU2V0IHRvIGZhbHNlIHRvIGVuYWJsZSBieSBkZWZhdWx0XHJcblxyXG4gICAgICAgICAgICAvLyBSZWdpc3RlciB0aGUgTGVhZmxldC1HZW9tYW4gdG9vbGJhclxyXG4gICAgICAgICAgICBtYXAucG0uYWRkQ29udHJvbHMoe1xyXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IFwidG9wbGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgZHJhd01hcmtlcjogZmFsc2UsIC8vIERpc2FibGUgZHJhd2luZyBtYXJrZXJzICh1c2UgeW91ciBjbHVzdGVyIG1hcmtlcnMgaW5zdGVhZClcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBMLmNvbnRyb2wubG9jYXRlKCkuYWRkVG8obWFwKTtcclxuXHJcbiAgICAgICAgICAgIEwudGVybWluYXRvcigpLmFkZFRvKG1hcCk7XHJcblxyXG4gICAgICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXJtaW5hdG9yLnNldFRpbWUoKTtcclxuICAgICAgICAgICAgfSwgNjAwMDApOyAvLyBFdmVyeSBtaW51dGVcclxuXHJcbiAgICAgICAgICAgIC8vIEFkZCBMZWFmbGV0IFNpZGViYXJcclxuICAgICAgICAgICAgY29uc3Qgc2lkZWJhciA9IEwuY29udHJvbFxyXG4gICAgICAgICAgICAgICAgLnNpZGViYXIoe1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dG9wYW46IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNsb3NlQnV0dG9uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogXCJzaWRlYmFyXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwibGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5hZGRUbyhtYXApO1xyXG5cclxuICAgICAgICAgICAgLy8gQWRkIGEgcGFuZWwgdG8gdGhlIHNpZGViYXJcclxuICAgICAgICAgICAgc2lkZWJhci5hZGRQYW5lbCh7XHJcbiAgICAgICAgICAgICAgICBpZDogXCJDb250ZW50XCIsXHJcbiAgICAgICAgICAgICAgICB0YWI6ICc8aSBjbGFzcz1cImZhIGZhLWluZm9cIj48L2k+JyxcclxuICAgICAgICAgICAgICAgIHBhbmU6IGBcclxuICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPVwidG9nZ2xlTWFya2VyQ2x1c3RlclwiPlRvZ2dsZSBNYXJrZXIgQ2x1c3RlcjwvYnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gaWQ9XCJzdGFydFBsYXliYWNrXCI+U3RhcnQgUGxheWJhY2s8L2J1dHRvbj5cclxuICAgICAgICA8YnV0dG9uIGlkPVwic3RvcFBsYXliYWNrXCI+U3RvcCBQbGF5YmFjazwvYnV0dG9uPmAsXHJcbiAgICAgICAgICAgICAgICB0aXRsZTogXCJTaWRlYmFyXCIsXHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3BcIixcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBsYXllciBjb250cm9sIGFuZCBhZGQgaXQgdG8gdGhlIG1hcFxyXG4gICAgICAgICAgICBMLmNvbnRyb2wubGF5ZXJzKGJhc2VMYXllcnMpLmFkZFRvKG1hcCk7XHJcblxyXG4gICAgICAgICAgICAvLyBFdmVudCBoYW5kbGVyIGZvciB0aGUgYnV0dG9uIHRvIHRvZ2dsZSBNYXJrZXIgQ2x1c3RlclxyXG4gICAgICAgICAgICBkb2N1bWVudFxyXG4gICAgICAgICAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwidG9nZ2xlTWFya2VyQ2x1c3RlclwiKVxyXG4gICAgICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ2x1c3RlckVuYWJsZWQgPSAhbWFya2VyQ2x1c3RlckVuYWJsZWQ7IC8vIFRvZ2dsZSB0aGUgc3RhdGVcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGV4aXN0aW5nIG1hcmtlcnMgb3IgbWFya2VyIGNsdXN0ZXJcclxuICAgICAgICAgICAgICAgICAgICBtYXAucmVtb3ZlTGF5ZXIobWFya2Vycyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEZldGNoIEFJUyBkYXRhIGZyb20gdGhlIEFQSVxyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJodHRwczovL2tzb3AuY2FrcmF3YWxhLmlkL2FwaS9haXNkYXRhdW5pcXVlXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWlzRGF0YSA9IHJlc3BvbnNlLmRhdGEubWVzc2FnZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlY3JlYXRlIG1hcmtlcnMgb3IgbWFya2VyIGNsdXN0ZXIgYmFzZWQgb24gdGhlIG5ldyBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlcnMgPSBjcmVhdGVNYXJrZXJzKGFpc0RhdGEsIG1hcmtlckNsdXN0ZXJFbmFibGVkKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbWFya2VycyBvciBtYXJrZXIgY2x1c3RlciB0byB0aGUgbWFwXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcC5hZGRMYXllcihtYXJrZXJzKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgQUlTIGRhdGE6XCIsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIEV2ZW50IGhhbmRsZXIgdG8gc3RhcnQgcGxheWJhY2tcclxuICAgICAgICAgICAgZG9jdW1lbnRcclxuICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50QnlJZChcInN0YXJ0UGxheWJhY2tcIilcclxuICAgICAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrUGxheWJhY2suc3RhcnQoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gRXZlbnQgaGFuZGxlciB0byBzdG9wIHBsYXliYWNrXHJcbiAgICAgICAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgICAgICAgICAuZ2V0RWxlbWVudEJ5SWQoXCJzdG9wUGxheWJhY2tcIilcclxuICAgICAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrUGxheWJhY2suc3RvcCgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgIH07XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGNyZWF0ZSBtYXJrZXJzIG9yIG1hcmtlciBjbHVzdGVyIGJhc2VkIG9uIHRoZSBkYXRhIGFuZCBtYXJrZXJDbHVzdGVyRW5hYmxlZFxyXG5mdW5jdGlvbiBjcmVhdGVNYXJrZXJzKGRhdGEsIG1hcmtlckNsdXN0ZXJFbmFibGVkKSB7XHJcbiAgICBjb25zdCBuZXdNYXJrZXJzID0gbWFya2VyQ2x1c3RlckVuYWJsZWRcclxuICAgICAgICA/IEwubWFya2VyQ2x1c3Rlckdyb3VwKClcclxuICAgICAgICA6IEwuZmVhdHVyZUdyb3VwKCk7XHJcblxyXG4gICAgZGF0YS5mb3JFYWNoKChhaXNJdGVtKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbWFya2VyID0gTC5tYXJrZXIoW1xyXG4gICAgICAgICAgICBhaXNJdGVtLmxhdGl0dWRlLFxyXG4gICAgICAgICAgICBhaXNJdGVtLmxvbmdpdHVkZSxcclxuICAgICAgICBdKS5iaW5kUG9wdXAoYEFJUyBEYXRhOiAke0pTT04uc3RyaW5naWZ5KGFpc0l0ZW0pfWApO1xyXG5cclxuICAgICAgICAvLyBjb25zdCBwMSA9IFsrYWlzSXRlbS5sYXRpdHVkZSB8fCAwLCArYWlzSXRlbS5sb25naXR1ZGUgfHwgMF07XHJcbiAgICAgICAgLy8gY29uc3QgdHJ1ZUhlYWRpbmcxID0gYWlzSXRlbS5oZWFkaW5nIHx8IDA7XHJcbiAgICAgICAgLy8gY29uc3QgY29nMSA9IGFpc0l0ZW0uY291cnNlIHx8IDA7XHJcbiAgICAgICAgLy8gY29uc3Qgc29nMSA9ICthaXNJdGVtLnNwZWVkIHx8IDA7XHJcblxyXG4gICAgICAgIC8vIC8vIENyZWF0aW5nIHRoZSBQb3NpdGlvblJlcG9ydFxyXG4gICAgICAgIC8vIGxldCBwb3NpdGlvblJlcG9ydDEgPSB7XHJcbiAgICAgICAgLy8gICAgIGxhdGl0dWRlOiBwMVswXSxcclxuICAgICAgICAvLyAgICAgbG9uZ2l0dWRlOiBwMVsxXSxcclxuICAgICAgICAvLyAgICAgdHJ1ZUhlYWRpbmc6IHRydWVIZWFkaW5nMSxcclxuICAgICAgICAvLyAgICAgY29nOiBjb2cxLFxyXG4gICAgICAgIC8vICAgICBzb2c6IHNvZzEsXHJcbiAgICAgICAgLy8gfTtcclxuXHJcbiAgICAgICAgLy8gY29uc3QgYWlzVHJhY2tTeW1ib2wgPSBuZXcgTC5haXNUcmFja1N5bWJvbChwb3NpdGlvblJlcG9ydDEsIHtcclxuICAgICAgICAvLyAgICAgc2hpcFN0YXRpY0RhdGE6IHtcclxuICAgICAgICAvLyAgICAgICAgIHVzZXJJZDogYWlzSXRlbS52ZXNzZWwuaWQgfHwgMCxcclxuICAgICAgICAvLyAgICAgICAgIGltb051bWJlcjogYWlzSXRlbS52ZXNzZWwuaW1vIHx8IDAsXHJcbiAgICAgICAgLy8gICAgICAgICBjYWxsU2lnbjogYWlzSXRlbS52ZXNzZWwuY2FsbHNpZ24gfHwgXCJcIixcclxuICAgICAgICAvLyAgICAgICAgIG5hbWU6IGFpc0l0ZW0udmVzc2VsLnZlc3NlbF9uYW1lIHx8IFwiXCIsXHJcbiAgICAgICAgLy8gICAgICAgICB0eXBlOiBhaXNJdGVtLnZlc3NlbC50eXBlX251bWJlciB8fCAwLFxyXG4gICAgICAgIC8vICAgICAgICAgZGltZW5zaW9uOiB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgQTogYWlzSXRlbS52ZXNzZWwuZGltZW5zaW9uX3RvX2JvdyB8fCAwLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIEI6IGFpc0l0ZW0udmVzc2VsLmRpbWVuc2lvbl90b19zdGVybiB8fCAwLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIEM6IGFpc0l0ZW0udmVzc2VsLmRpbWVuc2lvbl90b19wb3J0IHx8IDAsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgRDogYWlzSXRlbS52ZXNzZWwuZGltZW5zaW9uX3RvX3N0YXJib2FyZCB8fCAwLFxyXG4gICAgICAgIC8vICAgICAgICAgfSxcclxuICAgICAgICAvLyAgICAgICAgIGZpeFR5cGU6IGFpc0l0ZW0udmVzc2VsLm91dF9vZl9yYW5nZSB8fCAwLFxyXG4gICAgICAgIC8vICAgICAgICAgZXRhOiB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgbW9udGg6IGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2V0YVxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICA/IG5ldyBEYXRlKGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2V0YSkuZ2V0TW9udGgoKSArIDFcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgOiBudWxsLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGRheTogYWlzSXRlbS52ZXNzZWwucmVwb3J0ZWRfZXRhXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgID8gbmV3IERhdGUoYWlzSXRlbS52ZXNzZWwucmVwb3J0ZWRfZXRhKS5nZXREYXRlKClcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgOiBudWxsLFxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGhvdXI6IGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2V0YVxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICA/IG5ldyBEYXRlKGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2V0YSkuZ2V0SG91cnMoKVxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICA6IG51bGwsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgbWludXRlOiBhaXNJdGVtLnZlc3NlbC5yZXBvcnRlZF9ldGFcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgPyBuZXcgRGF0ZShhaXNJdGVtLnZlc3NlbC5yZXBvcnRlZF9ldGEpLmdldE1pbnV0ZXMoKVxyXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICA6IG51bGwsXHJcbiAgICAgICAgLy8gICAgICAgICB9LFxyXG4gICAgICAgIC8vICAgICAgICAgZGVzdGluYXRpb246IGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2Rlc3RpbmF0aW9uIHx8IFwiXCIsXHJcbiAgICAgICAgLy8gICAgICAgICBkdGU6IGFpc0l0ZW0udmVzc2VsLmR0ZSA9PT0gXCIxXCIsXHJcbiAgICAgICAgLy8gICAgIH0sXHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICAgICAgLy8gYWlzVHJhY2tTeW1ib2wuYmluZFRvb2x0aXAoYWlzSXRlbS52ZXNzZWwudmVzc2VsX25hbWUgfHwgXCJcIik7XHJcbiAgICAgICAgLy8gYWlzVHJhY2tTeW1ib2wuYWRkVG8obWFwKTtcclxuXHJcbiAgICAgICAgaWYgKGFpc0l0ZW0uaXNfaW5zaWRlX2dlb2ZlbmNlID09PSAxKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHB1bHNpbmdJY29uID0gTC5pY29uLnB1bHNlKHtcclxuICAgICAgICAgICAgICAgIGljb25TaXplOiBbMTAsIDEwXSxcclxuICAgICAgICAgICAgICAgIGNvbG9yOiBcInJlZFwiLFxyXG4gICAgICAgICAgICAgICAgZmlsbENvbG9yOiBcInJlZFwiLFxyXG4gICAgICAgICAgICAgICAgYW5pbWF0ZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHB1bHNlQ29sb3I6IFwicmVkXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0SWNvbihwdWxzaW5nSWNvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBuZXdNYXJrZXJzLmFkZExheWVyKG1hcmtlcik7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gbmV3TWFya2VycztcclxufVxyXG4iXSwKICAibWFwcGluZ3MiOiAiO0FBQWUsU0FBUixpQkFBa0M7QUFDckMsTUFBSSx1QkFBdUI7QUFDM0IsTUFBSTtBQUNKLE1BQUk7QUFDSixNQUFJO0FBQ0osU0FBTztBQUFBLElBQ0gsTUFBTSxpQkFBa0I7QUFDcEIsWUFBTSxFQUFFLElBQUksS0FBSyxNQUFNLElBQUksRUFBRSxFQUFFO0FBQUEsUUFDM0IsQ0FBQyxxQkFBcUIsa0JBQWtCO0FBQUEsUUFDeEM7QUFBQSxNQUNKO0FBRUEsWUFBTSxRQUFRLEVBQUUsVUFDWCxTQUFTLHNCQUFzQixFQUMvQixNQUFNLEdBQUc7QUFHZCxZQUFNLGFBQWE7QUFBQSxRQUNmLGVBQWU7QUFBQSxRQUNm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
