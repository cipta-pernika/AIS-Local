// resources/js/aismaps.js
function leafletAISMaps() {
  let markerClusterEnabled = false;
  let markers;
  let map;
  let trackPlayback;
  return {
    init: async function() {
      map = L.map(this.$refs.map.id).setView(
        [-1.5499571228201094, 117.89427962462793],
        5.4
      );
      const tiles = L.tileLayer.provider("OpenStreetMap.Mapnik").addTo(map);
      const baseLayers = {
        OpenStreetMap: tiles,
        "Google Maps": L.tileLayer(
          "https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}",
          {
            attribution: "Google Maps"
          }
        )
      };
      var ts = new L.aisTrackSymbol({});
      ts.addData({
        msgId: 4,
        mmsi: 24422002,
        name: "demo",
        utcYear: 2016,
        utcMon: 11,
        utcDay: 14,
        utcHour: 13,
        utcMin: 40,
        utcSec: 30,
        posAcc: 1,
        longitude: 8.155278333333333,
        latitude: 54.185555,
        devType: 7,
        raim: 0,
        comstate: { syncState: 0, slotTimeout: 2, slotNr: 1150 },
        timestamp: 1479130830744
      });
      ts.addTo(map);
      try {
        const response = await axios.get(
          "https://lumensopbuntut.cakrawala.id/api/aisdataunique"
        );
        const aisData = response.data.message;
        markers = createMarkers(aisData, markerClusterEnabled);
        map.addLayer(markers);
      } catch (error) {
        console.error("Error fetching AIS data:", error);
      }
      try {
        const data = {
          mmsi: "",
          dateFrom: "2024-01-03",
          dateTo: "2024-01-04",
          sensor: ["ais"]
        };
        const playbackResponse = await axios.post(
          "https://backend.sopbuntutksopbjm.com/api/playback",
          data
        );
        const playbackData = playbackResponse.data.message.ais[0].playback;
        trackPlayback = L.trackplayback(playbackData, map, {
          trackPointOptions: {
            /* Additional options for track points */
          },
          markerOptions: {
            /* Additional options for playback markers */
          }
        });
        const trackplaybackControl = L.trackplaybackcontrol(trackPlayback);
        trackplaybackControl.addTo(map);
        trackPlayback.start();
      } catch (error) {
        console.error("Error fetching AIS data:", error);
      }
      map.on("load", function() {
      });
      map.pm.setGlobalOptions({ optIn: false });
      map.pm.addControls({
        position: "topleft",
        drawMarker: false
        // Disable drawing markers (use your cluster markers instead)
      });
      L.control.locate().addTo(map);
      L.terminator().addTo(map);
      setInterval(function() {
        terminator.setTime();
      }, 6e4);
      const sidebar = L.control.sidebar({
        autopan: false,
        closeButton: true,
        container: "sidebar",
        position: "left"
      }).addTo(map);
      sidebar.addPanel({
        id: "Content",
        tab: '<i class="fa fa-info"></i>',
        pane: `
                       <button id="toggleMarkerCluster">Toggle Marker Cluster</button>
                       <button id="startPlayback">Start Playback</button>
        <button id="stopPlayback">Stop Playback</button>`,
        title: "Sidebar",
        position: "top"
      });
      L.control.layers(baseLayers).addTo(map);
      document.getElementById("toggleMarkerCluster").addEventListener("click", async function() {
        markerClusterEnabled = !markerClusterEnabled;
        map.removeLayer(markers);
        try {
          const response = await axios.get(
            "https://ksop.cakrawala.id/api/aisdataunique"
          );
          const aisData = response.data.message;
          markers = createMarkers(aisData, markerClusterEnabled);
          map.addLayer(markers);
        } catch (error) {
          console.error("Error fetching AIS data:", error);
        }
      });
      document.getElementById("startPlayback").addEventListener("click", function() {
        trackPlayback.start();
      });
      document.getElementById("stopPlayback").addEventListener("click", function() {
        trackPlayback.stop();
      });
    }
  };
}
function createMarkers(data, markerClusterEnabled) {
  const newMarkers = markerClusterEnabled ? L.markerClusterGroup() : L.featureGroup();
  data.forEach((aisItem) => {
    const marker = L.marker([
      aisItem.latitude,
      aisItem.longitude
    ]).bindPopup(`AIS Data: ${JSON.stringify(aisItem)}`);
    if (aisItem.is_inside_geofence === 1) {
      const pulsingIcon = L.icon.pulse({
        iconSize: [10, 10],
        color: "red",
        fillColor: "red",
        animate: true,
        pulseColor: "red"
      });
      marker.setIcon(pulsingIcon);
    }
    newMarkers.addLayer(marker);
  });
  return newMarkers;
}
export {
  leafletAISMaps as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vYWlzbWFwcy5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbGVhZmxldEFJU01hcHMoKSB7XG4gICAgbGV0IG1hcmtlckNsdXN0ZXJFbmFibGVkID0gZmFsc2U7XG4gICAgbGV0IG1hcmtlcnM7XG4gICAgbGV0IG1hcDtcbiAgICBsZXQgdHJhY2tQbGF5YmFjaztcbiAgICByZXR1cm4ge1xuICAgICAgICBpbml0OiBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBtYXAgPSBMLm1hcCh0aGlzLiRyZWZzLm1hcC5pZCkuc2V0VmlldyhcbiAgICAgICAgICAgICAgICBbLTEuNTQ5OTU3MTIyODIwMTA5NCwgMTE3Ljg5NDI3OTYyNDYyNzkzXSxcbiAgICAgICAgICAgICAgICA1LjRcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGNvbnN0IHRpbGVzID0gTC50aWxlTGF5ZXJcbiAgICAgICAgICAgICAgICAucHJvdmlkZXIoXCJPcGVuU3RyZWV0TWFwLk1hcG5pa1wiKVxuICAgICAgICAgICAgICAgIC5hZGRUbyhtYXApO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgYSBiYXNlIGxheWVycyBvYmplY3RcbiAgICAgICAgICAgIGNvbnN0IGJhc2VMYXllcnMgPSB7XG4gICAgICAgICAgICAgICAgT3BlblN0cmVldE1hcDogdGlsZXMsXG4gICAgICAgICAgICAgICAgXCJHb29nbGUgTWFwc1wiOiBMLnRpbGVMYXllcihcbiAgICAgICAgICAgICAgICAgICAgXCJodHRwczovL210MS5nb29nbGUuY29tL3Z0L2x5cnM9ciZ4PXt4fSZ5PXt5fSZ6PXt6fVwiLFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogXCJHb29nbGUgTWFwc1wiLFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciB0cyA9IG5ldyBMLmFpc1RyYWNrU3ltYm9sKHt9KTtcblxuICAgICAgICAgICAgdHMuYWRkRGF0YSh7XG4gICAgICAgICAgICAgICAgbXNnSWQ6IDQsXG4gICAgICAgICAgICAgICAgbW1zaTogMjQ0MjIwMDIsXG4gICAgICAgICAgICAgICAgbmFtZTogXCJkZW1vXCIsXG4gICAgICAgICAgICAgICAgdXRjWWVhcjogMjAxNixcbiAgICAgICAgICAgICAgICB1dGNNb246IDExLFxuICAgICAgICAgICAgICAgIHV0Y0RheTogMTQsXG4gICAgICAgICAgICAgICAgdXRjSG91cjogMTMsXG4gICAgICAgICAgICAgICAgdXRjTWluOiA0MCxcbiAgICAgICAgICAgICAgICB1dGNTZWM6IDMwLFxuICAgICAgICAgICAgICAgIHBvc0FjYzogMSxcbiAgICAgICAgICAgICAgICBsb25naXR1ZGU6IDguMTU1Mjc4MzMzMzMzMzMzLFxuICAgICAgICAgICAgICAgIGxhdGl0dWRlOiA1NC4xODU1NTUsXG4gICAgICAgICAgICAgICAgZGV2VHlwZTogNyxcbiAgICAgICAgICAgICAgICByYWltOiAwLFxuICAgICAgICAgICAgICAgIGNvbXN0YXRlOiB7IHN5bmNTdGF0ZTogMCwgc2xvdFRpbWVvdXQ6IDIsIHNsb3ROcjogMTE1MCB9LFxuICAgICAgICAgICAgICAgIHRpbWVzdGFtcDogMTQ3OTEzMDgzMDc0NCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdHMuYWRkVG8obWFwKTtcblxuICAgICAgICAgICAgLy8gRmV0Y2ggQUlTIGRhdGEgZnJvbSB0aGUgQVBJIGFuZCBjcmVhdGUgbWFya2Vyc1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldChcbiAgICAgICAgICAgICAgICAgICAgXCJodHRwczovL2x1bWVuc29wYnVudHV0LmNha3Jhd2FsYS5pZC9hcGkvYWlzZGF0YXVuaXF1ZVwiXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBjb25zdCBhaXNEYXRhID0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlO1xuXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG1hcmtlcnMgb3IgbWFya2VyIGNsdXN0ZXIgYmFzZWQgb24gdGhlIGluaXRpYWwgZGF0YVxuICAgICAgICAgICAgICAgIG1hcmtlcnMgPSBjcmVhdGVNYXJrZXJzKGFpc0RhdGEsIG1hcmtlckNsdXN0ZXJFbmFibGVkKTtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbWFya2VycyBvciBtYXJrZXIgY2x1c3RlciB0byB0aGUgbWFwXG4gICAgICAgICAgICAgICAgbWFwLmFkZExheWVyKG1hcmtlcnMpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgQUlTIGRhdGE6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRmV0Y2ggQUlTIGRhdGEgZnJvbSB0aGUgQVBJIGFuZCBjcmVhdGUgbWFya2Vyc1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBtbXNpOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICBkYXRlRnJvbTogXCIyMDI0LTAxLTAzXCIsXG4gICAgICAgICAgICAgICAgICAgIGRhdGVUbzogXCIyMDI0LTAxLTA0XCIsXG4gICAgICAgICAgICAgICAgICAgIHNlbnNvcjogW1wiYWlzXCJdLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY29uc3QgcGxheWJhY2tSZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoXG4gICAgICAgICAgICAgICAgICAgIFwiaHR0cHM6Ly9iYWNrZW5kLnNvcGJ1bnR1dGtzb3Biam0uY29tL2FwaS9wbGF5YmFja1wiXG4gICAgICAgICAgICAgICAgLCBkYXRhKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwbGF5YmFja0RhdGEgPSBwbGF5YmFja1Jlc3BvbnNlLmRhdGEubWVzc2FnZS5haXNbMF0ucGxheWJhY2s7XG5cbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBUcmFja1BsYXliYWNrIGluc3RhbmNlXG4gICAgICAgICAgICAgICAgdHJhY2tQbGF5YmFjayA9IEwudHJhY2twbGF5YmFjayhwbGF5YmFja0RhdGEsIG1hcCwge1xuICAgICAgICAgICAgICAgICAgICB0cmFja1BvaW50T3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogQWRkaXRpb25hbCBvcHRpb25zIGZvciB0cmFjayBwb2ludHMgKi9cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyT3B0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogQWRkaXRpb25hbCBvcHRpb25zIGZvciBwbGF5YmFjayBtYXJrZXJzICovXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB0cmFja3BsYXliYWNrQ29udHJvbCA9IEwudHJhY2twbGF5YmFja2NvbnRyb2wodHJhY2tQbGF5YmFjayk7XG5cbiAgICB0cmFja3BsYXliYWNrQ29udHJvbC5hZGRUbyhtYXApO1xuXG4gICAgICAgICAgICAgICAgdHJhY2tQbGF5YmFjay5zdGFydCgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgQUlTIGRhdGE6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWFwLm9uKFwibG9hZFwiLCBmdW5jdGlvbiAoKSB7fSk7XG5cbiAgICAgICAgICAgIC8vIEVuYWJsZSBMZWFmbGV0LUdlb21hbiBvbiB0aGUgbWFwXG4gICAgICAgICAgICBtYXAucG0uc2V0R2xvYmFsT3B0aW9ucyh7IG9wdEluOiBmYWxzZSB9KTsgLy8gU2V0IHRvIGZhbHNlIHRvIGVuYWJsZSBieSBkZWZhdWx0XG5cbiAgICAgICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBMZWFmbGV0LUdlb21hbiB0b29sYmFyXG4gICAgICAgICAgICBtYXAucG0uYWRkQ29udHJvbHMoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcInRvcGxlZnRcIixcbiAgICAgICAgICAgICAgICBkcmF3TWFya2VyOiBmYWxzZSwgLy8gRGlzYWJsZSBkcmF3aW5nIG1hcmtlcnMgKHVzZSB5b3VyIGNsdXN0ZXIgbWFya2VycyBpbnN0ZWFkKVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIEwuY29udHJvbC5sb2NhdGUoKS5hZGRUbyhtYXApO1xuXG4gICAgICAgICAgICBMLnRlcm1pbmF0b3IoKS5hZGRUbyhtYXApO1xuXG4gICAgICAgICAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGVybWluYXRvci5zZXRUaW1lKCk7XG4gICAgICAgICAgICB9LCA2MDAwMCk7IC8vIEV2ZXJ5IG1pbnV0ZVxuXG4gICAgICAgICAgICAvLyBBZGQgTGVhZmxldCBTaWRlYmFyXG4gICAgICAgICAgICBjb25zdCBzaWRlYmFyID0gTC5jb250cm9sXG4gICAgICAgICAgICAgICAgLnNpZGViYXIoe1xuICAgICAgICAgICAgICAgICAgICBhdXRvcGFuOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VCdXR0b246IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogXCJzaWRlYmFyXCIsXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcImxlZnRcIixcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5hZGRUbyhtYXApO1xuXG4gICAgICAgICAgICAvLyBBZGQgYSBwYW5lbCB0byB0aGUgc2lkZWJhclxuICAgICAgICAgICAgc2lkZWJhci5hZGRQYW5lbCh7XG4gICAgICAgICAgICAgICAgaWQ6IFwiQ29udGVudFwiLFxuICAgICAgICAgICAgICAgIHRhYjogJzxpIGNsYXNzPVwiZmEgZmEtaW5mb1wiPjwvaT4nLFxuICAgICAgICAgICAgICAgIHBhbmU6IGBcbiAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cInRvZ2dsZU1hcmtlckNsdXN0ZXJcIj5Ub2dnbGUgTWFya2VyIENsdXN0ZXI8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD1cInN0YXJ0UGxheWJhY2tcIj5TdGFydCBQbGF5YmFjazwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGlkPVwic3RvcFBsYXliYWNrXCI+U3RvcCBQbGF5YmFjazwvYnV0dG9uPmAsXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiU2lkZWJhclwiLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcInRvcFwiLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIGxheWVyIGNvbnRyb2wgYW5kIGFkZCBpdCB0byB0aGUgbWFwXG4gICAgICAgICAgICBMLmNvbnRyb2wubGF5ZXJzKGJhc2VMYXllcnMpLmFkZFRvKG1hcCk7XG5cbiAgICAgICAgICAgIC8vIEV2ZW50IGhhbmRsZXIgZm9yIHRoZSBidXR0b24gdG8gdG9nZ2xlIE1hcmtlciBDbHVzdGVyXG4gICAgICAgICAgICBkb2N1bWVudFxuICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50QnlJZChcInRvZ2dsZU1hcmtlckNsdXN0ZXJcIilcbiAgICAgICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ2x1c3RlckVuYWJsZWQgPSAhbWFya2VyQ2x1c3RlckVuYWJsZWQ7IC8vIFRvZ2dsZSB0aGUgc3RhdGVcblxuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZXhpc3RpbmcgbWFya2VycyBvciBtYXJrZXIgY2x1c3RlclxuICAgICAgICAgICAgICAgICAgICBtYXAucmVtb3ZlTGF5ZXIobWFya2Vycyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gRmV0Y2ggQUlTIGRhdGEgZnJvbSB0aGUgQVBJXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImh0dHBzOi8va3NvcC5jYWtyYXdhbGEuaWQvYXBpL2Fpc2RhdGF1bmlxdWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFpc0RhdGEgPSByZXNwb25zZS5kYXRhLm1lc3NhZ2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlY3JlYXRlIG1hcmtlcnMgb3IgbWFya2VyIGNsdXN0ZXIgYmFzZWQgb24gdGhlIG5ldyBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZXJzID0gY3JlYXRlTWFya2VycyhhaXNEYXRhLCBtYXJrZXJDbHVzdGVyRW5hYmxlZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbWFya2VycyBvciBtYXJrZXIgY2x1c3RlciB0byB0aGUgbWFwXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXAuYWRkTGF5ZXIobWFya2Vycyk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgQUlTIGRhdGE6XCIsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBFdmVudCBoYW5kbGVyIHRvIHN0YXJ0IHBsYXliYWNrXG4gICAgICAgICAgICBkb2N1bWVudFxuICAgICAgICAgICAgICAgIC5nZXRFbGVtZW50QnlJZChcInN0YXJ0UGxheWJhY2tcIilcbiAgICAgICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tQbGF5YmFjay5zdGFydCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBFdmVudCBoYW5kbGVyIHRvIHN0b3AgcGxheWJhY2tcbiAgICAgICAgICAgIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwic3RvcFBsYXliYWNrXCIpXG4gICAgICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrUGxheWJhY2suc3RvcCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgIH07XG59XG5cbi8vIEZ1bmN0aW9uIHRvIGNyZWF0ZSBtYXJrZXJzIG9yIG1hcmtlciBjbHVzdGVyIGJhc2VkIG9uIHRoZSBkYXRhIGFuZCBtYXJrZXJDbHVzdGVyRW5hYmxlZFxuZnVuY3Rpb24gY3JlYXRlTWFya2VycyhkYXRhLCBtYXJrZXJDbHVzdGVyRW5hYmxlZCkge1xuICAgIGNvbnN0IG5ld01hcmtlcnMgPSBtYXJrZXJDbHVzdGVyRW5hYmxlZFxuICAgICAgICA/IEwubWFya2VyQ2x1c3Rlckdyb3VwKClcbiAgICAgICAgOiBMLmZlYXR1cmVHcm91cCgpO1xuXG4gICAgZGF0YS5mb3JFYWNoKChhaXNJdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IG1hcmtlciA9IEwubWFya2VyKFtcbiAgICAgICAgICAgIGFpc0l0ZW0ubGF0aXR1ZGUsXG4gICAgICAgICAgICBhaXNJdGVtLmxvbmdpdHVkZSxcbiAgICAgICAgXSkuYmluZFBvcHVwKGBBSVMgRGF0YTogJHtKU09OLnN0cmluZ2lmeShhaXNJdGVtKX1gKTtcblxuICAgICAgICAvLyBjb25zdCBwMSA9IFsrYWlzSXRlbS5sYXRpdHVkZSB8fCAwLCArYWlzSXRlbS5sb25naXR1ZGUgfHwgMF07XG4gICAgICAgIC8vIGNvbnN0IHRydWVIZWFkaW5nMSA9IGFpc0l0ZW0uaGVhZGluZyB8fCAwO1xuICAgICAgICAvLyBjb25zdCBjb2cxID0gYWlzSXRlbS5jb3Vyc2UgfHwgMDtcbiAgICAgICAgLy8gY29uc3Qgc29nMSA9ICthaXNJdGVtLnNwZWVkIHx8IDA7XG5cbiAgICAgICAgLy8gLy8gQ3JlYXRpbmcgdGhlIFBvc2l0aW9uUmVwb3J0XG4gICAgICAgIC8vIGxldCBwb3NpdGlvblJlcG9ydDEgPSB7XG4gICAgICAgIC8vICAgICBsYXRpdHVkZTogcDFbMF0sXG4gICAgICAgIC8vICAgICBsb25naXR1ZGU6IHAxWzFdLFxuICAgICAgICAvLyAgICAgdHJ1ZUhlYWRpbmc6IHRydWVIZWFkaW5nMSxcbiAgICAgICAgLy8gICAgIGNvZzogY29nMSxcbiAgICAgICAgLy8gICAgIHNvZzogc29nMSxcbiAgICAgICAgLy8gfTtcblxuICAgICAgICAvLyBjb25zdCBhaXNUcmFja1N5bWJvbCA9IG5ldyBMLmFpc1RyYWNrU3ltYm9sKHBvc2l0aW9uUmVwb3J0MSwge1xuICAgICAgICAvLyAgICAgc2hpcFN0YXRpY0RhdGE6IHtcbiAgICAgICAgLy8gICAgICAgICB1c2VySWQ6IGFpc0l0ZW0udmVzc2VsLmlkIHx8IDAsXG4gICAgICAgIC8vICAgICAgICAgaW1vTnVtYmVyOiBhaXNJdGVtLnZlc3NlbC5pbW8gfHwgMCxcbiAgICAgICAgLy8gICAgICAgICBjYWxsU2lnbjogYWlzSXRlbS52ZXNzZWwuY2FsbHNpZ24gfHwgXCJcIixcbiAgICAgICAgLy8gICAgICAgICBuYW1lOiBhaXNJdGVtLnZlc3NlbC52ZXNzZWxfbmFtZSB8fCBcIlwiLFxuICAgICAgICAvLyAgICAgICAgIHR5cGU6IGFpc0l0ZW0udmVzc2VsLnR5cGVfbnVtYmVyIHx8IDAsXG4gICAgICAgIC8vICAgICAgICAgZGltZW5zaW9uOiB7XG4gICAgICAgIC8vICAgICAgICAgICAgIEE6IGFpc0l0ZW0udmVzc2VsLmRpbWVuc2lvbl90b19ib3cgfHwgMCxcbiAgICAgICAgLy8gICAgICAgICAgICAgQjogYWlzSXRlbS52ZXNzZWwuZGltZW5zaW9uX3RvX3N0ZXJuIHx8IDAsXG4gICAgICAgIC8vICAgICAgICAgICAgIEM6IGFpc0l0ZW0udmVzc2VsLmRpbWVuc2lvbl90b19wb3J0IHx8IDAsXG4gICAgICAgIC8vICAgICAgICAgICAgIEQ6IGFpc0l0ZW0udmVzc2VsLmRpbWVuc2lvbl90b19zdGFyYm9hcmQgfHwgMCxcbiAgICAgICAgLy8gICAgICAgICB9LFxuICAgICAgICAvLyAgICAgICAgIGZpeFR5cGU6IGFpc0l0ZW0udmVzc2VsLm91dF9vZl9yYW5nZSB8fCAwLFxuICAgICAgICAvLyAgICAgICAgIGV0YToge1xuICAgICAgICAvLyAgICAgICAgICAgICBtb250aDogYWlzSXRlbS52ZXNzZWwucmVwb3J0ZWRfZXRhXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICA/IG5ldyBEYXRlKGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2V0YSkuZ2V0TW9udGgoKSArIDFcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgLy8gICAgICAgICAgICAgZGF5OiBhaXNJdGVtLnZlc3NlbC5yZXBvcnRlZF9ldGFcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgID8gbmV3IERhdGUoYWlzSXRlbS52ZXNzZWwucmVwb3J0ZWRfZXRhKS5nZXREYXRlKClcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIDogbnVsbCxcbiAgICAgICAgLy8gICAgICAgICAgICAgaG91cjogYWlzSXRlbS52ZXNzZWwucmVwb3J0ZWRfZXRhXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICA/IG5ldyBEYXRlKGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2V0YSkuZ2V0SG91cnMoKVxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAvLyAgICAgICAgICAgICBtaW51dGU6IGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2V0YVxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgPyBuZXcgRGF0ZShhaXNJdGVtLnZlc3NlbC5yZXBvcnRlZF9ldGEpLmdldE1pbnV0ZXMoKVxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgOiBudWxsLFxuICAgICAgICAvLyAgICAgICAgIH0sXG4gICAgICAgIC8vICAgICAgICAgZGVzdGluYXRpb246IGFpc0l0ZW0udmVzc2VsLnJlcG9ydGVkX2Rlc3RpbmF0aW9uIHx8IFwiXCIsXG4gICAgICAgIC8vICAgICAgICAgZHRlOiBhaXNJdGVtLnZlc3NlbC5kdGUgPT09IFwiMVwiLFxuICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgLy8gfSk7XG4gICAgICAgIC8vIGFpc1RyYWNrU3ltYm9sLmJpbmRUb29sdGlwKGFpc0l0ZW0udmVzc2VsLnZlc3NlbF9uYW1lIHx8IFwiXCIpO1xuICAgICAgICAvLyBhaXNUcmFja1N5bWJvbC5hZGRUbyhtYXApO1xuXG4gICAgICAgIGlmIChhaXNJdGVtLmlzX2luc2lkZV9nZW9mZW5jZSA9PT0gMSkge1xuICAgICAgICAgICAgY29uc3QgcHVsc2luZ0ljb24gPSBMLmljb24ucHVsc2Uoe1xuICAgICAgICAgICAgICAgIGljb25TaXplOiBbMTAsIDEwXSxcbiAgICAgICAgICAgICAgICBjb2xvcjogXCJyZWRcIixcbiAgICAgICAgICAgICAgICBmaWxsQ29sb3I6IFwicmVkXCIsXG4gICAgICAgICAgICAgICAgYW5pbWF0ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwdWxzZUNvbG9yOiBcInJlZFwiLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBtYXJrZXIuc2V0SWNvbihwdWxzaW5nSWNvbik7XG4gICAgICAgIH1cblxuICAgICAgICBuZXdNYXJrZXJzLmFkZExheWVyKG1hcmtlcik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gbmV3TWFya2Vycztcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7QUFBZSxTQUFSLGlCQUFrQztBQUNyQyxNQUFJLHVCQUF1QjtBQUMzQixNQUFJO0FBQ0osTUFBSTtBQUNKLE1BQUk7QUFDSixTQUFPO0FBQUEsSUFDSCxNQUFNLGlCQUFrQjtBQUNwQixZQUFNLEVBQUUsSUFBSSxLQUFLLE1BQU0sSUFBSSxFQUFFLEVBQUU7QUFBQSxRQUMzQixDQUFDLHFCQUFxQixrQkFBa0I7QUFBQSxRQUN4QztBQUFBLE1BQ0o7QUFFQSxZQUFNLFFBQVEsRUFBRSxVQUNYLFNBQVMsc0JBQXNCLEVBQy9CLE1BQU0sR0FBRztBQUdkLFlBQU0sYUFBYTtBQUFBLFFBQ2YsZUFBZTtBQUFBLFFBQ2YsZUFBZSxFQUFFO0FBQUEsVUFDYjtBQUFBLFVBQ0E7QUFBQSxZQUNJLGFBQWE7QUFBQSxVQUNqQjtBQUFBLFFBQ0o7QUFBQSxNQUNKO0FBRUEsVUFBSSxLQUFLLElBQUksRUFBRSxlQUFlLENBQUMsQ0FBQztBQUVoQyxTQUFHLFFBQVE7QUFBQSxRQUNQLE9BQU87QUFBQSxRQUNQLE1BQU07QUFBQSxRQUNOLE1BQU07QUFBQSxRQUNOLFNBQVM7QUFBQSxRQUNULFFBQVE7QUFBQSxRQUNSLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxRQUNULFFBQVE7QUFBQSxRQUNSLFFBQVE7QUFBQSxRQUNSLFFBQVE7QUFBQSxRQUNSLFdBQVc7QUFBQSxRQUNYLFVBQVU7QUFBQSxRQUNWLFNBQVM7QUFBQSxRQUNULE1BQU07QUFBQSxRQUNOLFVBQVUsRUFBRSxXQUFXLEdBQUcsYUFBYSxHQUFHLFFBQVEsS0FBSztBQUFBLFFBQ3ZELFdBQVc7QUFBQSxNQUNmLENBQUM7QUFDRCxTQUFHLE1BQU0sR0FBRztBQUdaLFVBQUk7QUFDQSxjQUFNLFdBQVcsTUFBTSxNQUFNO0FBQUEsVUFDekI7QUFBQSxRQUNKO0FBQ0EsY0FBTSxVQUFVLFNBQVMsS0FBSztBQUc5QixrQkFBVSxjQUFjLFNBQVMsb0JBQW9CO0FBR3JELFlBQUksU0FBUyxPQUFPO0FBQUEsTUFDeEIsU0FBUyxPQUFPO0FBQ1osZ0JBQVEsTUFBTSw0QkFBNEIsS0FBSztBQUFBLE1BQ25EO0FBR0EsVUFBSTtBQUNBLGNBQU0sT0FBTztBQUFBLFVBQ1QsTUFBTTtBQUFBLFVBQ04sVUFBVTtBQUFBLFVBQ1YsUUFBUTtBQUFBLFVBQ1IsUUFBUSxDQUFDLEtBQUs7QUFBQSxRQUNsQjtBQUNBLGNBQU0sbUJBQW1CLE1BQU0sTUFBTTtBQUFBLFVBQ2pDO0FBQUEsVUFDRjtBQUFBLFFBQUk7QUFDTixjQUFNLGVBQWUsaUJBQWlCLEtBQUssUUFBUSxJQUFJLENBQUMsRUFBRTtBQUcxRCx3QkFBZ0IsRUFBRSxjQUFjLGNBQWMsS0FBSztBQUFBLFVBQy9DLG1CQUFtQjtBQUFBO0FBQUEsVUFFbkI7QUFBQSxVQUNBLGVBQWU7QUFBQTtBQUFBLFVBRWY7QUFBQSxRQUNKLENBQUM7QUFFRCxjQUFNLHVCQUF1QixFQUFFLHFCQUFxQixhQUFhO0FBRTdFLDZCQUFxQixNQUFNLEdBQUc7QUFFbEIsc0JBQWMsTUFBTTtBQUFBLE1BQ3hCLFNBQVMsT0FBTztBQUNaLGdCQUFRLE1BQU0sNEJBQTRCLEtBQUs7QUFBQSxNQUNuRDtBQUVBLFVBQUksR0FBRyxRQUFRLFdBQVk7QUFBQSxNQUFDLENBQUM7QUFHN0IsVUFBSSxHQUFHLGlCQUFpQixFQUFFLE9BQU8sTUFBTSxDQUFDO0FBR3hDLFVBQUksR0FBRyxZQUFZO0FBQUEsUUFDZixVQUFVO0FBQUEsUUFDVixZQUFZO0FBQUE7QUFBQSxNQUNoQixDQUFDO0FBRUQsUUFBRSxRQUFRLE9BQU8sRUFBRSxNQUFNLEdBQUc7QUFFNUIsUUFBRSxXQUFXLEVBQUUsTUFBTSxHQUFHO0FBRXhCLGtCQUFZLFdBQVk7QUFDcEIsbUJBQVcsUUFBUTtBQUFBLE1BQ3ZCLEdBQUcsR0FBSztBQUdSLFlBQU0sVUFBVSxFQUFFLFFBQ2IsUUFBUTtBQUFBLFFBQ0wsU0FBUztBQUFBLFFBQ1QsYUFBYTtBQUFBLFFBQ2IsV0FBVztBQUFBLFFBQ1gsVUFBVTtBQUFBLE1BQ2QsQ0FBQyxFQUNBLE1BQU0sR0FBRztBQUdkLGNBQVEsU0FBUztBQUFBLFFBQ2IsSUFBSTtBQUFBLFFBQ0osS0FBSztBQUFBLFFBQ0wsTUFBTTtBQUFBO0FBQUE7QUFBQTtBQUFBLFFBSU4sT0FBTztBQUFBLFFBQ1AsVUFBVTtBQUFBLE1BQ2QsQ0FBQztBQUdELFFBQUUsUUFBUSxPQUFPLFVBQVUsRUFBRSxNQUFNLEdBQUc7QUFHdEMsZUFDSyxlQUFlLHFCQUFxQixFQUNwQyxpQkFBaUIsU0FBUyxpQkFBa0I7QUFDekMsK0JBQXVCLENBQUM7QUFHeEIsWUFBSSxZQUFZLE9BQU87QUFHdkIsWUFBSTtBQUNBLGdCQUFNLFdBQVcsTUFBTSxNQUFNO0FBQUEsWUFDekI7QUFBQSxVQUNKO0FBQ0EsZ0JBQU0sVUFBVSxTQUFTLEtBQUs7QUFHOUIsb0JBQVUsY0FBYyxTQUFTLG9CQUFvQjtBQUdyRCxjQUFJLFNBQVMsT0FBTztBQUFBLFFBQ3hCLFNBQVMsT0FBTztBQUNaLGtCQUFRLE1BQU0sNEJBQTRCLEtBQUs7QUFBQSxRQUNuRDtBQUFBLE1BQ0osQ0FBQztBQUdMLGVBQ0ssZUFBZSxlQUFlLEVBQzlCLGlCQUFpQixTQUFTLFdBQVk7QUFDbkMsc0JBQWMsTUFBTTtBQUFBLE1BQ3hCLENBQUM7QUFHTCxlQUNLLGVBQWUsY0FBYyxFQUM3QixpQkFBaUIsU0FBUyxXQUFZO0FBQ25DLHNCQUFjLEtBQUs7QUFBQSxNQUN2QixDQUFDO0FBQUEsSUFDVDtBQUFBLEVBQ0o7QUFDSjtBQUdBLFNBQVMsY0FBYyxNQUFNLHNCQUFzQjtBQUMvQyxRQUFNLGFBQWEsdUJBQ2IsRUFBRSxtQkFBbUIsSUFDckIsRUFBRSxhQUFhO0FBRXJCLE9BQUssUUFBUSxDQUFDLFlBQVk7QUFDdEIsVUFBTSxTQUFTLEVBQUUsT0FBTztBQUFBLE1BQ3BCLFFBQVE7QUFBQSxNQUNSLFFBQVE7QUFBQSxJQUNaLENBQUMsRUFBRSxVQUFVLGFBQWEsS0FBSyxVQUFVLE9BQU8sQ0FBQyxFQUFFO0FBbURuRCxRQUFJLFFBQVEsdUJBQXVCLEdBQUc7QUFDbEMsWUFBTSxjQUFjLEVBQUUsS0FBSyxNQUFNO0FBQUEsUUFDN0IsVUFBVSxDQUFDLElBQUksRUFBRTtBQUFBLFFBQ2pCLE9BQU87QUFBQSxRQUNQLFdBQVc7QUFBQSxRQUNYLFNBQVM7QUFBQSxRQUNULFlBQVk7QUFBQSxNQUNoQixDQUFDO0FBQ0QsYUFBTyxRQUFRLFdBQVc7QUFBQSxJQUM5QjtBQUVBLGVBQVcsU0FBUyxNQUFNO0FBQUEsRUFDOUIsQ0FBQztBQUVELFNBQU87QUFDWDsiLAogICJuYW1lcyI6IFtdCn0K
